#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <time.h>
#include <ctype.h>

void print0(){
	printf("====================================\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("====================================\n");
}

void print1(){
	printf("====================================\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|  ______________________________  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print2(){
	printf("====================================\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|                                  |\n");
	printf("|     ________________________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print3(){
	printf("====================================\n");
	printf("|           __                     |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print4(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |      \\/            |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print5(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |     _\\/_           |\n");
	printf("|          |  |    /    \\          |\n");
	printf("|          |  |    |    |          |\n");
	printf("|          |  |    \\____/          |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print6(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |     _\\/_           |\n");
	printf("|          |  |    /    \\          |\n");
	printf("|          |  |    |    |          |\n");
	printf("|          |  |    \\____/          |\n");
	printf("|          |  |     _||_           |\n");
	printf("|          |  |     |  |           |\n");
	printf("|          |  |     |  |           |\n");
	printf("|          |  |     |  |           |\n");
	printf("|          |  |     |  |           |\n");
	printf("|          |  |     |__|           |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print7(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |     _\\/_           |\n");
	printf("|          |  |    /    \\          |\n");
	printf("|          |  |    |    |          |\n");
	printf("|          |  |    \\____/          |\n");
	printf("|          |  |    __||_           |\n");
	printf("|          |  |   //|  |           |\n");
	printf("|          |  |  // |  |           |\n");
	printf("|          |  | //  |  |           |\n");
	printf("|          |  |/_\\  |  |           |\n");
	printf("|          |  |     |__|           |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print8(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |     _\\/_           |\n");
	printf("|          |  |    /    \\          |\n");
	printf("|          |  |    |    |          |\n");
	printf("|          |  |    \\____/          |\n");
	printf("|          |  |    __||__          |\n");
	printf("|          |  |   //|  |\\\\         |\n");
	printf("|          |  |  // |  | \\\\        |\n");
	printf("|          |  | //  |  |  \\\\       |\n");
	printf("|          |  |/_\\  |  |  /_\\      |\n");
	printf("|          |  |     |__|           |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|          |  |                    |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print9(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |     _\\/_           |\n");
	printf("|          |  |    /    \\          |\n");
	printf("|          |  |    |    |          |\n");
	printf("|          |  |    \\____/          |\n");
	printf("|          |  |    __||__          |\n");
	printf("|          |  |   //|  |\\\\         |\n");
	printf("|          |  |  // |  | \\\\        |\n");
	printf("|          |  | //  |  |  \\\\       |\n");
	printf("|          |  |/_\\  |  |  /_\\      |\n");
	printf("|          |  |     |__|           |\n");
	printf("|          |  |    //              |\n");
	printf("|          |  |   //               |\n");
	printf("|          |  | _//                |\n");
	printf("|          |  |/_/                 |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void print10(){
	printf("====================================\n");
	printf("|           _____________          |\n");
	printf("|          |   ______  __|         |\n");
	printf("|          |  |     _\\/_   ======  |\n");
	printf("|          |  |    /    \\  |You |  |\n");
	printf("|          |  |    |x  x|  |Lose|  |\n");
	printf("|          |  |    \\____/  ======  |\n");
	printf("|          |  |    __||__          |\n");
	printf("|          |  |   //|  |\\\\         |\n");
	printf("|          |  |  // |  | \\\\        |\n");
	printf("|          |  | //  |  |  \\\\       |\n");
	printf("|          |  |/_\\  |  |  /_\\      |\n");
	printf("|          |  |     |__|           |\n");
	printf("|          |  |    //  \\\\          |\n");
	printf("|          |  |   //    \\\\         |\n");
	printf("|          |  | _//      \\\\_       |\n");
	printf("|          |  |/_/        \\_\\      |\n");
	printf("|     _____|  |_______________     |\n");
	printf("|  __/________________________\\__  |\n");
	printf("| /______________________________\\ |\n");
	printf("====================================\n");
}

void printWin(){
	printf("====================================\n");
	printf("|                                  |\n");
	printf("|             ========             |\n");
	printf("|             | You  |             |\n");
	printf("|             | Win  |             |\n");
	printf("|             ========             |\n");
	printf("|           _   ____   _           |\n");
	printf("|          \\ / /    \\ \\ /          |\n");
	printf("|           \\\\ |^  ^| //           |\n");
	printf("|            \\\\\\____///            |\n");
	printf("|             \\\\_||_//             |\n");
	printf("|               |  |               |\n");
	printf("|               |  |               |\n");
	printf("|               |  |               |\n");
	printf("|               |  |               |\n");
	printf("====================================\n");
}

void printBye(){
	printf("====================================\n");
	printf("|                                  |\n");
	printf("|          =================       |\n");
	printf("|          | Thank You     |       |\n");
	printf("|          | For Playing!  |       |\n");
	printf("|          =================       |\n");
	printf("|               ____   _           |\n");
	printf("|              /    \\ \\ /          |\n");
	printf("|              |^  ^| //           |\n");
	printf("|              \\____///            |\n");
	printf("|               _||_//             |\n");
	printf("|             //|  |               |\n");
	printf("|            // |  |               |\n");
	printf("|           //  |  |               |\n");
	printf("|          /_\\  |  |               |\n");
	printf("====================================\n");
}

struct words{
	char str[11];
};

struct Node{
	char letter;
	int idx;
	struct Node *next;
};

struct Node *answer[5];

struct Node *addNode(char letter, int idx){
	struct Node *newNode = (struct Node *) malloc (sizeof(struct Node));
	newNode->letter = letter;
	newNode->idx = idx;
	newNode->next = NULL;
	return newNode;
}

void firstData(char letter, int idx, int num){
	struct Node *newNode = addNode(letter,idx);
	answer[num] = newNode;
}

void push(char letter, int idx, int num){
	struct Node *newNode = addNode(letter,idx);
	newNode->next = answer[num];
	answer[num] = newNode;
}

bool unique(int idx, struct words check[], char input[]){
	for(int i=0;i<idx;i++){
//		printf("%s == %s?\n",check[i],input);
		if(strcmp(check[i].str,input) == 0) return false;
	}
	return true;
}

int search(char letter, struct words question[]){
	int found = 0;
	for(int i=0;i<5;i++){
		if(answer[i] == NULL){
			continue;
		}
		else{
			struct Node *curr = answer[i];
			while(curr != NULL){
			    if(curr->letter == letter){
			        question[i].str[curr->idx] = letter;
			        answer[i] = answer[i]->next;
			        curr->next = NULL;
			        free(curr);
			        curr = answer[i];
			        found = 1;
			    }
			    else if(curr->next != NULL && curr->next->letter == letter){
			        struct Node *temp = curr->next;
			        question[i].str[temp->idx] = letter;
			        curr->next = temp->next;
			        temp->next = NULL;
			        free(temp);
			        found = 1;
			    }
			    else{
			        curr = curr->next;
			    }
			}
		}
	}
	return found;
}

void popAll(){
	for(int i=0;i<5;i++){
		while(answer[i] != NULL){
			struct Node *temp = answer[i]->next;
			free(answer[i]);
			answer[i] = temp;
		}
	}
}

void printList(){
	for(int i=0;i<5;i++){
		printf("i = %d\n",i);
		struct Node *temp = answer[i];
		while(temp != NULL){
			printf("%c(%d)->",temp->letter,temp->idx);
			temp = temp->next;
		}
		printf("NULL\n");
	}
}

void printfunc(int wrong){
	system("cls");
	if(wrong == 0){
		print0();
		return;
	}
	else if(wrong == 1){
		print1();
		return;
	}
	else if(wrong == 2){
		print2();
		return;
	}
	else if(wrong == 3){
		print3();
		return;
	}
	else if(wrong == 4){
		print4();
		return;
	}
	else if(wrong == 5){
		print5();
		return;
	}
	else if(wrong == 6){
		print6();
		return;
	}
	else if(wrong == 7){
		print7();
		return;
	}
	else if(wrong == 8){
		print8();
		return;
	}
	else if(wrong == 9){
		print9();
		return;
	}
	else if(wrong == 10){
		print10();
		return;
	}
}


int main(){
	char input[12];
	struct words inputStruct[1000];
	int a = 0;
	printf("==================================\n");
	printf("| Input strings (max 10 letters) |\n");
	printf("| Max 1000 strings               |\n");
	printf("| type \"!done\" to stop input     |\n");
	printf("==================================\n");
	while(a < 1000){
		scanf("%s",input);
		int len = strlen(input);
		if(strcmp(input,"!done") == 0 && a < 5){
			printf("Not Enough Strings!\n");
			continue;
		}
		else if(strcmp(input,"!done") == 0) break;
		if(len > 10){
			printf("Word length Exceeds 10, try again!\n");
			continue;
		}
		int valid = 1;
		for(int i=0;i<len;i++){
			input[i] = tolower(input[i]);
			if(input[i]<'a' || input[i]>'z'){
				valid = 0;
				break;
			}
		}
		if(valid == 0){
			printf("invalid input!\n");
			continue;
		}
		bool check = unique(a,inputStruct,input);
		if(check == false){
			printf("String already exists!\n");
			continue;
		}
//		printf("%s\n",input);
		strcpy(inputStruct[a++].str,input);
//		inputStruct[a++].size = len;
	}
	
	while(true){
//		printList();
		struct words question[5];
		srand(time(NULL));
		for(int i=0;i<5;i++){
//			printf("%d\n",i);
			int random = rand()%a;
//			printf("%d\n",random);
//			char prompt[11];
			strcpy(question[i].str,inputStruct[random].str);
			bool check = unique(i,question,question[i].str);
			if(check == false){
				i--;
				continue;
			}
			int idx = 0;
			while(question[i].str[idx] != '\0'){
				push(question[i].str[idx],idx,i);
//				question[i].str[idx] = '_';
				idx++;
			}
		}
		
		for(int i=0;i<5;i++){
			int idx = 0;
			while(question[i].str[idx] != '\0'){
				question[i].str[idx] = '_';
				idx++;
			}
		}
		bool win = false;
		int wrong = 0;
		int alph[26] = {0};
		while(wrong < 10){
			int complete = 0;
			printfunc(wrong);
			printf("Attempted Letters: ");
			for(int i=0;i<26;i++){
				if(alph[i] == 1) printf("%c ",i+'a');
			}
			printf("\n");
			printf("====================================\n");
			for(int i=0;i<5;i++){
				int idx = 0;
				int check = 0;
				while(question[i].str[idx] != '\0'){
					printf("%c ",question[i].str[idx]);
					if(question[i].str[idx] == '_') check = 1;
					idx++;
				}
				printf("\n");
				if(check == 0) complete++;
			}
//			printf("%d\n",complete);
			if(complete == 5){
				win = true;
				break;
			}
			char ans;
			scanf(" %c",&ans);
			ans = tolower(ans);
			if(alph[ans-'a'] == 0){
				alph[ans-'a'] = 1;
			}
			else{
				continue;
			}
			int right = search(ans, question);
			if(right == 0){
				wrong++;
			}
		}
		system("cls");
		if(win == true) printWin();
		else printfunc(wrong);
		for(int i=0;i<5;i++){
			int idx = 0;
			int check = 0;
			while(question[i].str[idx] != '\0'){
				printf("%c ",question[i].str[idx]);
				idx++;
			}
			printf("\n");
		}
		popAll();
		char exit;
		printf("===============\n");
		printf("| Play Again? |\n");
		printf("| (Y) or (N)  |\n");
		printf("===============\n");
		scanf(" %c",&exit);
		while(exit != 'N' && exit != 'Y'){
			printf("Invalid Input! Try again\n");
			scanf(" %c",&exit);
		}
		if(exit == 'N'){
			system("cls");
			printBye();
			break;
		}
	}
 	return 0;
}


